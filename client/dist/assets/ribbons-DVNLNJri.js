(function(r,l){typeof window=="object"&&(window[r]=l())})("Ribbons",function(){var r=window,l=document.body,c=document.documentElement,u=function(){if(arguments.length===1){if(Array.isArray(arguments[0])){var t=Math.round(u(0,arguments[0].length-1));return arguments[0][t]}return u(0,arguments[0])}else{if(arguments.length===2)return Math.random()*(arguments[1]-arguments[0])+arguments[0];if(arguments.length===4){var i=[arguments[0],arguments[1],arguments[2],arguments[3]];return i[Math.floor(Math.random()*i.length)]}}return 0},g=function(t){var i=Math.max(0,r.innerWidth||c.clientWidth||l.clientWidth||0),n=Math.max(0,r.innerHeight||c.clientHeight||l.clientHeight||0),h=Math.max(0,r.pageXOffset||c.scrollLeft||l.scrollLeft||0)-(c.clientLeft||0),s=Math.max(0,r.pageYOffset||c.scrollTop||l.scrollTop||0)-(c.clientTop||0);return{width:i,height:n,ratio:i/n,centerx:i/2,centery:n/2,scrollx:h,scrolly:s}},e=function(t,i){this.x=0,this.y=0,this.set(t,i)};e.prototype={constructor:e,set:function(t,i){this.x=t||0,this.y=i||0},copy:function(t){return this.x=t.x||0,this.y=t.y||0,this},multiply:function(t,i){return this.x*=t||1,this.y*=i||1,this},divide:function(t,i){return this.x/=t||1,this.y/=i||1,this},add:function(t,i){return this.x+=t||0,this.y+=i||0,this},subtract:function(t,i){return this.x-=t||0,this.y-=i||0,this},clampX:function(t,i){return this.x=Math.max(t,Math.min(this.x,i)),this},clampY:function(t,i){return this.y=Math.max(t,Math.min(this.y,i)),this},flipX:function(){return this.x*=-1,this},flipY:function(){return this.y*=-1,this}};var f=function(t){this._canvas=null,this._context=null,this._sto=null,this._width=0,this._height=0,this._scroll=0,this._ribbons=[],this._options={colorSaturation:"80%",colorBrightness:"60%",colorAlpha:.65,colorCycleSpeed:6,verticalPosition:"center",horizontalSpeed:150,ribbonCount:3,strokeSize:0,parallaxAmount:-.5,animateSections:!0},this._onDraw=this._onDraw.bind(this),this._onResize=this._onResize.bind(this),this._onScroll=this._onScroll.bind(this),this.setOptions(t),this.init()};return f.prototype={constructor:f,setOptions:function(t){if(typeof t=="object")for(var i in t)t.hasOwnProperty(i)&&(this._options[i]=t[i])},init:function(){try{this._canvas=document.createElement("canvas"),this._canvas.style.display="block",this._canvas.style.position="fixed",this._canvas.style.margin="0",this._canvas.style.padding="0",this._canvas.style.border="0",this._canvas.style.outline="0",this._canvas.style.left="0",this._canvas.style.top="0",this._canvas.style.width="100%",this._canvas.style.height="100%",this._canvas.style["z-index"]="0",this._canvas.style.pointerEvents="none",this._canvas.className="ribbon-canvas",this._onResize(),this._context=this._canvas.getContext("2d"),this._context.clearRect(0,0,this._width,this._height),this._context.globalAlpha=this._options.colorAlpha,window.addEventListener("resize",this._onResize),window.addEventListener("scroll",this._onScroll),document.body.appendChild(this._canvas)}catch(t){console.warn("Canvas Context Error: "+t.toString());return}this._onDraw()},addRibbon:function(){var t=Math.round(u(1,9))>5?"right":"left",i=1e3,n=200,h=0-n,s=this._width+n,_=0,o=0,y=t==="right"?h:s,d=Math.round(u(0,this._height));/^(top|min)$/i.test(this._options.verticalPosition)?d=0+n:/^(middle|center)$/i.test(this._options.verticalPosition)?d=this._height/2:/^(bottom|max)$/i.test(this._options.verticalPosition)&&(d=this._height-n);for(var b=[],x=new e(y,d),a=new e(y,d),p=null,m=Math.round(u(35,35,40,40)),v=0;!(i<=0);){if(i--,_=Math.round((Math.random()*1-.2)*this._options.horizontalSpeed),o=Math.round((Math.random()*1-.5)*(this._height*.25)),p=new e,p.copy(a),t==="right"){if(p.add(_,o),a.x>=s)break}else if(t==="left"&&(p.subtract(_,o),a.x<=h))break;b.push({point1:new e(x.x,x.y),point2:new e(a.x,a.y),point3:p,color:m,delay:v,dir:t,alpha:0,phase:0}),x.copy(a),a.copy(p),v+=4}this._ribbons.push(b)},_drawRibbonSection:function(t){if(t){if(t.phase>=1&&t.alpha<=0)return!0;if(t.delay<=0){if(t.phase+=.02,t.alpha=Math.sin(t.phase)*1,t.alpha=t.alpha<=0?0:t.alpha,t.alpha=t.alpha>=1?1:t.alpha,this._options.animateSections){var i=Math.sin(1+t.phase*Math.PI/2)*.1;t.dir==="right"?(t.point1.add(i,0),t.point2.add(i,0),t.point3.add(i,0)):(t.point1.subtract(i,0),t.point2.subtract(i,0),t.point3.subtract(i,0)),t.point1.add(0,i),t.point2.add(0,i),t.point3.add(0,i)}}else t.delay-=.5;var n=this._options.colorSaturation,h=this._options.colorBrightness,s="hsla("+t.color+", "+n+", "+h+", "+t.alpha+" )";this._context.save(),this._options.parallaxAmount!==0&&this._context.translate(0,this._scroll*this._options.parallaxAmount),this._context.beginPath(),this._context.moveTo(t.point1.x,t.point1.y),this._context.lineTo(t.point2.x,t.point2.y),this._context.lineTo(t.point3.x,t.point3.y),this._context.fillStyle=s,this._context.fill(),this._options.strokeSize>0&&(this._context.lineWidth=this._options.strokeSize,this._context.strokeStyle=s,this._context.lineCap="round",this._context.stroke()),this._context.restore()}return!1},_onDraw:function(){for(var t=0,i=this._ribbons.length;t<i;++t)this._ribbons[t]||this._ribbons.splice(t,1);this._context.clearRect(0,0,this._width,this._height);for(var n=0;n<this._ribbons.length;++n){for(var h=this._ribbons[n],s=h.length,_=0,o=0;o<s;++o)this._drawRibbonSection(h[o])&&_++;_>=s&&(this._ribbons[n]=null)}this._ribbons.length<this._options.ribbonCount&&this.addRibbon(),requestAnimationFrame(this._onDraw)},_onResize:function(t){var i=g();this._width=i.width,this._height=i.height,this._canvas&&(this._canvas.width=this._width,this._canvas.height=this._height,this._context&&(this._context.globalAlpha=this._options.colorAlpha))},_onScroll:function(t){var i=g();this._scroll=i.scrolly}},f});
